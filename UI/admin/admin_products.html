{% extends "admin/admin_layout.html" %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='style_admin.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='admin_product.css') }}">
{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="text-light mb-4 text-center">Manage Products</h2>

  <!-- Add Product -->
  <div class="card bg-dark p-4 mb-4 shadow-sm">
    <form method="POST" action="{{ url_for('admin_products') }}" enctype="multipart/form-data" class="row g-3 align-items-center">
      <div class="col-md-2">
        <input name="name" class="form-control" placeholder="Product Name" required>
      </div>

      <div class="col-md-2">
        <input name="description" class="form-control" placeholder="Description">
      </div>

      <div class="col-md-2">
        <input name="price" type="number" step="0.01" class="form-control" placeholder="Price" required>
      </div>

      <div class="col-md-2">
        <input name="stock_qty" type="number" class="form-control" placeholder="Stock" required>
      </div>

      <div class="col-md-2">
        <input type="file" name="image" class="form-control" accept="image/*">
      </div>

      <div class="col-md-2">
        <button type="submit" class="btn btn-success w-100">Add Product</button>
      </div>
    </form>
  </div>

  <!-- Product List -->
  <div class="card bg-dark p-3 shadow-sm">
    <table class="table table-dark table-striped table-hover align-middle mb-0">
      <thead class="table-light text-dark">
        <tr>
          <th>Image</th>
          <th>Name</th>
          <th>Description</th>
          <th>Price</th>
          <th>Stock</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for p in products %}
        <tr>
          <form method="POST" action="{{ url_for('admin_products', id=p.id) }}" enctype="multipart/form-data">
            <td>
              {% if p.image %}
                <img src="{{ url_for('static', filename='uploads/' + p.image) }}" alt="Product Image" width="60" height="60" class="rounded me-2">
              {% else %}
                <span class="text-muted small">No Image</span>
              {% endif %}
              <input type="file" name="image" class="form-control form-control-sm mt-1" accept="image/*">
            </td>
            <td><input name="name" value="{{ p.name }}" class="form-control bg-transparent text-light border-0"></td>
            <td><input name="description" value="{{ p.description }}" class="form-control bg-transparent text-light border-0"></td>
            <td><input name="price" type="number" step="0.01" value="{{ p.price }}" class="form-control bg-transparent text-light border-0"></td>
            <td><input name="stock_qty" type="number" value="{{ p.stock_qty }}" class="form-control bg-transparent text-light border-0"></td>
            <td class="text-center">
              <button type="submit" class="btn btn-sm btn-warning me-1">Update</button>
              <a href="{{ url_for('product_delete', id=p.id) }}" class="btn btn-sm btn-danger">Delete</a>
            </td>
          </form>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
